<!DOCTYPE html>
<html>
    <head>
        <style>

        </style>
    </head>
    
    <body>    
    
    <div id="content">
    </div>
    <script>
        // hjelpevariable for både view og controller
        var contentDiv = document.getElementById('content');

        // model
        let numbers = [7, 3, 10, 5, 8];
        let chosenBar = ""; // Variabel for hvilken stolpe som er valgt
        let inputValue; // Variabel for hva som er skrevet i input-feltet
        let errorMessage = "";

        // view
        show();
        function show() {
            let svgInnerHtml = '';
            let disable;
            if (chosenBar === "") {disable = "disabled"} else {disable = ""};
            for (let i = 0; i < numbers.length; i++) {
                svgInnerHtml += createBar(numbers[i], i + 1);
            }
            contentDiv.innerHTML = `
                <svg id="chart" width="400" height="400" viewbox="0 -40 100 100">
                    ${svgInnerHtml}
                </svg><br/>
                Valgt stolpe: <i>${chosenBar}</i>
                <br />
                Verdi:
                <input type="number" oninput="inputValue = this.value"> <br>
                <button onclick="addBar()" >Legg til stolpe</button> 
                <button ${disable} onclick="changeBar()" >Endre valgt stolpe</button>
                <button ${disable} onclick="removeBar()">Fjerne valgt stolpe</button> <br>
                <p>${errorMessage}</p>
                `;
        }
    //           button    ^
        function createBar(number, barNo) {
            const width = 8;
            const spacing = 2;
            let x = (barNo - 1) * (width + spacing);
            let height = number * 10;
            let y = 60 - height;
            let color = calcColor(1, 10, barNo);
            return `<rect  
                        onclick="borderControl(${barNo}),show();" ${chosenBar == barNo ? 'stroke="black"' : 'stroke=""'}
                         width="${width}" height="${height}" x="${x}" y="${y}" fill="${color}">
                    </rect>`;
                    
        }
    
        // hva er barNo = er på en måte id'en til bar  hva er chosenBar = 
        function calcColor(min, max, val) {
            var minHue = 240, maxHue = 0;
            var curPercent = (val - min) / (max - min);
            var colString = "hsl(" + ((curPercent * (maxHue - minHue)) + minHue) + ",100%,50%)";
            return colString;
        }
    
        // controller (ingenting her ennå)
        function borderControl(barNo) {
            // toggler av og på border på valgt stolpe
            if (chosenBar == barNo) {chosenBar = ""} else {chosenBar = barNo}
            show();
            //console.log(chosenBar)
        }

        function removeBar() {
            numbers.splice(chosenBar -1, 1);
            show();
        }

        function addBar() {
            if(inputValue <= 10 && inputValue >= 1) {
                numbers.push(inputValue);
                errorMessage = "";
                show();
            } else {
                errorMessage = "Verdien er ikke gyldig";
                show();
            }
            inputValue = "";
        }

        function changeBar() {
            if(inputValue <= 10 && inputValue >= 1) {
                numbers[chosenBar-1] = inputValue;
                errorMessage = "";
                show();
            } else {
                errorMessage = "Verdien er ikke gyldig";
                show();
            }
            inputValue = "";
        }
    </script>
    </body>
</html>